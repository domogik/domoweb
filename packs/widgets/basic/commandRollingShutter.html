<style>
@font-face {
  font-family: 'FontAwesome';
  src: url('/widget/basic/font-awesome-4.7.0/fonts/fontawesome-webfont.eot?v=4.7.0');
  src: url('/widget/basic/font-awesome-4.7.0/fonts/fontawesome-webfont.eot?#iefix&v=4.7.0') format('embedded-opentype'), url('/widget/basic/font-awesome-4.7.0/fonts/fontawesome-webfont.woff2?v=4.7.0') format('woff2'), url('/widget/basic/font-awesome-4.7.0/fonts/fontawesome-webfont.woff?v=4.7.0') format('woff'), url('/widget/basic/font-awesome-4.7.0/fonts/fontawesome-webfont.ttf?v=4.7.0') format('truetype'), url('/widget/basic/font-awesome-4.7.0/fonts/fontawesome-webfont.svg?v=4.7.0#fontawesomeregular') format('svg');
  font-weight: normal;
  font-style: normal;
}
</style>

<dom-module id="dmw-basic-commandrollingshutter">
    <template id="extended-styles">
        <style type="text/css">
            :host {
                height: 100%;
                --chevron-size : 3.5em;
                --chevron-line-height : 0.7 em;
            }
            button#open {
                position: absolute;
                display: block;
                border-style: none;
                width: 80%;
                height: 30%;
                top: 5%;
                left: 10%;
                padding: 2px;
                background-color: transparent;
            }
            button#close {
                position: absolute;
                display: block;
                border-style: none;
                width: 80%;
                height: 30%;
                bottom: 5%;
                left: 10%;
                padding:  0 2px 0 2px;
                background-color: transparent;
            }
            .fa.fa-xx {
                font-size: var(--chevron-size);
                position: relative;
                text-align: center;
                line-height : var(--chevron-line-height);
            }
        </style>
        <dmw-command id="primary" commandkey="primary" commandnotified="open: 0; close:1;"></dmw-command>
        <!--
        <dmw-sensor id='boolstate' sensorkey="boolstate" sensorvalue="{{boolstate}}"></dmw-sensor>
        -->
        <button id="open" class=""><i class="fa fa-angle-double-up fa-xx"></i></button>
        <button id="close" class=""><i class="fa fa-angle-double-down fa-xx"></i></button>
    </template>
    <script>
     (function () {
        let memoizedTemplate;

        class DmwBasicCommandRollingShutter extends DmwWidget {
            static get is () { return 'dmw-basic-commandrollingshutter'; }
            static get template() {
              if (!memoizedTemplate) {
                // start with clone of superclass template
                memoizedTemplate = DmwWidget.template.cloneNode(true);
                // get some stuff you want to insert into super template
                const subStyle = Polymer.DomModule.import(this.is, 'template#extended-styles').content;
                // insert stuff in template after the super template's <style>
                const superStyle = memoizedTemplate.content.querySelector('style');
                superStyle.parentNode.insertBefore(subStyle, superStyle.nextSibling);
              }
              return memoizedTemplate;
            }
            connectedCallback() {
                super.connectedCallback();
                //this.boolstate = null;
            }
            resized() {
                super.resized();
                const width = parseInt(this.getAttribute('width'));
                const height = parseInt(this.getAttribute('height'));
                let size = '3.5em';
                let lHeight = '0.7em';
                if (width == 2 && height > 2) {
                    size = '8em';
                    lHeight = '0.5em';
                }
                this.style.setProperty("--chevron-size", size);
                this.style.setProperty("--chevron-line-height", lHeight);
            }
            optionsUpdated() {
                if (this.options['hideLabels'] == true ) {
                    this.$.labelprimary.style.visibility = "hidden";
                    this.$.labelsecondary.style.visibility = "hidden";
                }
                else {
                    this.$.labelprimary.style.visibility = "visible";
                    this.$.labelsecondary.style.visibility = "visible";
                }
            }
            sensorsUpdated() {
                if (this.options['WidgetTextColor'] == undefined) {
                    this.$.open.style.color = "#ffffff";
                }
                else {
                    this.$.open.style.color = this.options['WidgetTextColor'];
                }
                if (this.options['WidgetTextColor'] == undefined) {
                    this.$.close.style.color = "#ffffff";
                }
                else {
                    this.$.close.style.color = this.options['WidgetTextColor'];
                }
            }
            commandsUpdated() {
                if (this.$.primary.isSet) {
                    this.labelprimary = this.$.primary.device['name'];
                    this.labelsecondary = this.$.primary.name;
                    this.$.open.addEventListener('click', this.open.bind(this));
                    this.$.close.addEventListener('click', this.close.bind(this));
                }
            }
            open(e) {
                var parameters = {};
                parameters[this.$.primary.parameters[0]['key']] = 0;
                this.$.primary.send(parameters);
                e.preventDefault();
                e.stopPropagation();
            }
            close(e) {
                var parameters = {};
                parameters[this.$.primary.parameters[0]['key']] = 1;
                this.$.primary.send(parameters);
                e.preventDefault();
                e.stopPropagation();
            }
	    };
        customElements.define(DmwBasicCommandRollingShutter.is, DmwBasicCommandRollingShutter);
    })();
    </script>
</dom-module>
