<dom-module id="dmw-health-vigipollens">
    <template id="extended-styles">
        <!-- ln -s /var/lib/domogik/domogik_packages/plugin_vigipollens/domoweb/packs/widgets/pollens  /opt/dmg/domoweb/packs/widgets/pollens -->

        <style type="text/css">
            #title {
                position: absolute;
                color: white;
                width: 100%;
                font-size: calc(1em*var(--wscale-h)*var(--wscale-r));
                font-weight: bold;
                text-align: center;
            }
            .contalergen {
                display: inline-flex;
                margin-top: calc(8px*var(--wscale-h)*var(--wscale-r));
                width: 100%;
            }
            .contalergen .alergencol {
                width : 50%;
                padding-left: calc(10px*var(--wscale-w));
            }
            .contlegend .legendcol {
                width : 33%;
                padding-left: calc(10px*var(--wscale-w));
            }
            .contlegend {
                display: inline-flex;
                margin-top: calc(3px*var(--wscale-h)*var(--wscale-r));
                width: 100%;
                border: 1px solid #0094CE;
            }
            .contalergen li,
            .contlegend li {
                height: calc(18px*var(--wscale-h));
                line-height: calc(18px*var(--wscale-h));
            }
            .alergenlevel {
                display: inline-block;
                height: calc(12px*var(--wscale-h));
                width: calc(12px*var(--wscale-w));
                margin-top: calc(2px*var(--wscale-h));
                margin-right: 4px;
                border-style: solid;
                border-width: 1px;
            }
            .alergenname {
                display: inline-block;
                font-size: calc(10px*var(--wscale-h)*var(--wscale-r));
                margin-left: 3px;
            }
            .legend {
                display: inline-block;
                font-size: calc(10px*var(--wscale-h)*var(--wscale-r));
                margin-left: 3px;
                vertical-align: top;
            }
            #alergencolor1  {
                background: #E0E0D1;
            }
            #alergencolor2  {
                background: #E0E0D1;
            }
            #alergencolor3  {
                background: #E0E0D1;
            }
            #alergencolor4  {
                background: #E0E0D1;
            }
            #alergencolor5  {
                background: #E0E0D1;
            }
            #alergencolor6  {
                background: #E0E0D1;
            }
            #alergencolor7  {
                background: #E0E0D1;
            }
            #alergencolor8  {
                background: #E0E0D1;
            }
            #alergencolor9  {
                background: #E0E0D1;
            }
            #alergencolor10  {
                background: #E0E0D1;
            }
            #alergencolor11  {
                background: #E0E0D1;
            }
            #alergencolor12  {
                background: #E0E0D1;
            }
            #alergencolor13  {
                background: #E0E0D1;
            }
            #alergencolor14  {
                background: #E0E0D1;
            }
            #alergencolor15  {
                background: #E0E0D1;
            }
            #alergencolor16  {
                background: #E0E0D1;
            }
            #alergencolor17  {
                background: #E0E0D1;
            }
            #alergencolor18  {
                background: #E0E0D1;
            }
            #alergencolor19  {
                background: #E0E0D1;
            }

            .legendicon {
                display: inline-block;
                height: calc(12px*var(--wscale-h));
                width: calc(12px*var(--wscale-w));
                opacity: 1;
                margin-top: calc(2px*var(--wscale-h));
                border-style: solid;
                border-width: 1px;
                vertical-align: top;
            }
            #icon5  {
                background: red;
            }
            #icon4  {
                background: orange;
            }
            #icon3  {
                background: yellow;
            }
            #icon2  {
                background: blue;
            }
            #icon1  {
                background: #31B404;
            }
            #icon0  {
                background: white;
            }
        </style>
        <shadow>
        <dmw-sensor id='vigilanceDepartement' sensorkey='vigilanceDepartement' sensorvalue='{{vigilanceDepartement_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorDepartement' sensorkey='vigilanceColorDepartement' sensorvalue='{{vigilanceColorDepartement_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorCupressaceae' sensorkey='vigilanceColorCupressaceae' sensorvalue='{{vigilanceColorCupressaceae_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorHazel' sensorkey='vigilanceColorHazel' sensorvalue='{{vigilanceColorHazel_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorAlder' sensorkey='vigilanceColorAlder' sensorvalue='{{vigilanceColorAlder_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorPoplar' sensorkey='vigilanceColorPoplar' sensorvalue='{{vigilanceColorPoplar_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorWillow' sensorkey='vigilanceColorWillow' sensorvalue='{{vigilanceColorWillow_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorAsh' sensorkey='vigilanceColorAsh' sensorvalue='{{vigilanceColorAsh_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorHomebeam' sensorkey='vigilanceColorHomebeam' sensorvalue='{{vigilanceColorHomebeam_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorBirsh' sensorkey='vigilanceColorBirsh' sensorvalue='{{vigilanceColorBirsh_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorPlane' sensorkey='vigilanceColorPlane' sensorvalue='{{vigilanceColorPlane_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorOak' sensorkey='vigilanceColorOak' sensorvalue='{{vigilanceColorOak_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorOlive' sensorkey='vigilanceColorOlive' sensorvalue='{{vigilanceColorOlive_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorLinden' sensorkey='vigilanceColorLinden' sensorvalue='{{vigilanceColorLinden_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorChestnut' sensorkey='vigilanceColorChestnut' sensorvalue='{{vigilanceColorChestnut_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorSorrel' sensorkey='vigilanceColorSorrel' sensorvalue='{{vigilanceColorSorrel_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorGrasses' sensorkey='vigilanceColorGrasses' sensorvalue='{{vigilanceColorGrasses_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorPlantain' sensorkey='vigilanceColorPlantain' sensorvalue='{{vigilanceColorPlantain_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorNettles' sensorkey='vigilanceColorNettles' sensorvalue='{{vigilanceColorNettles_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorMugwort' sensorkey='vigilanceColorMugwort' sensorvalue='{{vigilanceColorMugwort_value}}'></dmw-sensor>
        <dmw-sensor id='vigilanceColorRagweed' sensorkey='vigilanceColorRagweed' sensorvalue='{{vigilanceColorRagweed_value}}'></dmw-sensor>
        </shadow>

        <div id="title">{{ title }}</div><br>
        <div class="contalergen">
            <div class="alergencol">
                <li><div class="alergenlevel" id="alergencolor1"></div><span class="alergenname">Cupressacees</span></li>
                <li><div class="alergenlevel" id="alergencolor2"></div><span class="alergenname">Noisetiers</span></li>
                <li><div class="alergenlevel" id="alergencolor3"></div><span class="alergenname">Aulnes</span></li>
                <li><div class="alergenlevel" id="alergencolor4"></div><span class="alergenname">Peupliers</span></li>
                <li><div class="alergenlevel" id="alergencolor5"></div><span class="alergenname">Saule</span></li>
                <li><div class="alergenlevel" id="alergencolor6"></div><span class="alergenname">Frenes</span></li>
                <li><div class="alergenlevel" id="alergencolor7"></div><span class="alergenname">Charmes</span></li>
                <li><div class="alergenlevel" id="alergencolor8"></div><span class="alergenname">Bouleaux</span></li>
                <li><div class="alergenlevel" id="alergencolor9"></div><span class="alergenname">Platanes</span></li>
                <li><div class="alergenlevel" id="alergencolor10"></div><span class="alergenname">Chenes</span></li>
            </div>
            <div class="alergencol">
                <li><div class="alergenlevel" id="alergencolor11"></div><span class="alergenname">Olivier</span></li>
                <li><div class="alergenlevel" id="alergencolor12"></div><span class="alergenname">Tilleuls</span></li>
                <li><div class="alergenlevel" id="alergencolor13"></div><span class="alergenname">Chataigniers</span></li>
                <li><div class="alergenlevel" id="alergencolor14"></div><span class="alergenname">Rumex</span></li>
                <li><div class="alergenlevel" id="alergencolor15"></div><span class="alergenname">Graminees</span></li>
                <li><div class="alergenlevel" id="alergencolor16"></div><span class="alergenname">Plantains</span></li>
                <li><div class="alergenlevel" id="alergencolor17"></div><span class="alergenname">Urticacees</span></li>
                <li><div class="alergenlevel" id="alergencolor18"></div><span class="alergenname">Armoises</span></li>
                <li><div class="alergenlevel" id="alergencolor19"></div><span class="alergenname">Ambroisies</span></li>
            </div>
        </div>
        <div class="contlegend">
            <div class="legendcol">
                <li><div class="legendicon" id="icon0"></div><span class="legend">nul</span></li>
                <li><div class="legendicon" id="icon1"></div><span class="legend">faible</span></li>
            </div>
            <div class="legendcol">
                <li><div class="legendicon" id="icon2"></div><span class="legend">modéré</span></li>
                <li><div class="legendicon" id="icon3"></div><span class="legend">moyen</span></li>
            </div>
            <div class="legendcol">
                <li><div class="legendicon" id="icon4"></div><span class="legend">élévé</span></li>
                <li><div class="legendicon" id="icon5"></div><span class="legend">fort</span></li>
            </div>
        </div>

    </template>

    <script>
     (function () {
        let memoizedTemplate;

        class DmwHealthVigipollens extends DmwWidget {
            static get is () { return 'dmw-health-vigipollens'; }
            static get properties() {
                return {
                    DmwHealthVigipollens: {
                        notify: true,
                        observer: 'DmwHealthVigipollensChanged'
                    },
                    vigilanceDepartement_value: {
                        notify: true,
                        observer: 'vigilanceDepartement_valueChanged',
                    },
                    vigilanceColorDepartement_value: {
                        notify: true,
                        observer: 'vigilanceColorDepartement_valueChanged',
                    },
                    vigilanceColorCupressaceae_value: {
                        notify: true,
                        observer: 'vigilanceColorCupressaceae_valueChanged',
                    },
                    vigilanceColorHazel_value: {
                        notify: true,
                        observer: 'vigilanceColorHazel_valueChanged',
                    },
                    vigilanceColorAlder_value: {
                        notify: true,
                        observer: 'vigilanceColorAlder_valueChanged',
                    },
                    vigilanceColorPoplar_value: {
                        notify: true,
                        observer: 'vigilanceColorPoplar_valueChanged',
                    },
                    vigilanceColorWillow_value: {
                        notify: true,
                        observer: 'vigilanceColorWillow_valueChanged',
                    },
                    vigilanceColorAsh_value: {
                        notify: true,
                        observer: 'vigilanceColorAsh_valueChanged',
                    },
                    vigilanceColorHomebeam_value: {
                        notify: true,
                        observer: 'vigilanceColorHomebeam_valueChanged',
                    },
                    vigilanceColorBirsh_value: {
                        notify: true,
                        observer: 'vigilanceColorBirsh_valueChanged',
                    },
                    vigilanceColorPlane_value: {
                        notify: true,
                        observer: 'vigilanceColorPlane_valueChanged',
                    },
                    vigilanceColorOak_value: {
                        notify: true,
                        observer: 'vigilanceColorOak_valueChanged',
                    },
                    vigilanceColorOlive_value: {
                        notify: true,
                        observer: 'vigilanceColorOlive_valueChanged',
                    },
                    vigilanceColorLinden_value: {
                        notify: true,
                        observer: 'vigilanceColorLinden_valueChanged',
                    },
                    vigilanceColorChestnut_value: {
                        notify: true,
                        observer: 'vigilanceColorChestnut_valueChanged',
                    },
                    vigilanceColorSorrel_value: {
                        notify: true,
                        observer: 'vigilanceColorSorrel_valueChanged',
                    },
                    vigilanceColorGrasses_value: {
                        notify: true,
                        observer: 'vigilanceColorGrasses_valueChanged',
                    },
                    vigilanceColorPlantain_value: {
                        notify: true,
                        observer: 'vigilanceColorPlantain_valueChanged',
                    },
                    vigilanceColorPlantain_value: {
                        notify: true,
                        observer: 'vigilanceColorPlantain_valueChanged',
                    },
                    vigilanceColorNettles_value: {
                        notify: true,
                        observer: 'vigilanceColorNettles_valueChanged',
                    },
                    vigilanceColorMugwort_value: {
                        notify: true,
                        observer: 'vigilanceColorMugwort_valueChanged',
                    },
                    vigilanceColorRagweed_value: {
                        notify: true,
                        observer: 'vigilanceColorRagweed_valueChanged',
                    }
                }
            }
            static get template() {
              if (!memoizedTemplate) {
                // start with clone of superclass template
                memoizedTemplate = DmwWidget.template.cloneNode(true);
                // get some stuff you want to insert into super template
                const subStyle = Polymer.DomModule.import(this.is, 'template#extended-styles').content;
                // insert stuff in template after the super template's <style>
                const superStyle = memoizedTemplate.content.querySelector('style');
                superStyle.parentNode.insertBefore(subStyle, superStyle.nextSibling);
              }
              return memoizedTemplate;
            }
            constructor() {
                super();
                this.ratioConstraint = 'width';
            }
            connectedCallback() {
                super.connectedCallback();
            }

            vigilanceDepartement_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.title = "Risques allergiques du " + newValue
            }

            vigilanceColorDepartement_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.title.style.color = getVigipollenColor(newValue) ;
            }

            vigilanceColorCupressaceae_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor1.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorHazel_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor2.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorAlder_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor3.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorPoplar_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor4.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorWillow_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor5.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorAsh_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor6.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorHomebeam_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor7.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorBirsh_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor8.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorPlane_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor9.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorOak_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor10.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorOlive_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor11.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorLinden_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor12.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorChestnut_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor13.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorSorrel_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor14.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorGrasses_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor15.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorPlantain_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor16.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorNettles_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor17.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorMugwort_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor18.style.background = getVigipollenColor(newValue) ;
            }
            vigilanceColorRagweed_valueChanged(newValue, oldValue) {
                newValue = newValue.stored_value ;
                this.$.alergencolor19.style.background = getVigipollenColor(newValue) ;
            }

	    };

    function getVigipollenColor(color) {
            switch(color) {         // "white", "green", "blue", "yellow", "orange", "red"
                case 'W':
                    return "white" ;
                case 'G':
                    return "#31B404" ;
                case 'B':
                    return "blue" ;
                case 'Y':
                    return "yellow" ;
                case 'O':
                    return "orange" ;
                case 'R':
                    return "red" ;
                default:
                    return "white" ;
            }
        }
    customElements.define(DmwHealthVigipollens.is, DmwHealthVigipollens);
    })();
    </script>
</dom-module>
